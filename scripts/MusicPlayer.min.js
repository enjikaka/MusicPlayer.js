var Time={format:function(e){e=Math.floor(e);var a=Math.floor(e/60);a=a>=10?a:+a,e=Math.floor(e%60),e=e>=10?e:"0"+e;var t=a+":"+e;return t},seconds:function(e){return e=e.split(":"),60*parseInt(e[0])+parseInt(e[1])}},MusicPlayer={debug:!0,metadata:{title:null,artist:null,album:null,year:null,track:null,comment:null,genre:null,picture:null,lyrics:null},settings:{player:"#player",elements:{button:{play:"#play-button",stop:"#stop-button",next:"#next-button",previous:"#previous-button",open:"#open-file-button",volumeDown:"#volume-down-button",volumeUp:"#volume-up-button"},fileOpener:"#file-opener",waveformImage:"#waveform-imagery",metadata:{loadedFile:"#loaded-file",title:"#song-title",artist:"#song-artist",album:"#song-album",year:"#song-year",comment:"#song-comment",track:"#song-track",comment:"#song-comment",genre:"#song-genre",picture:"#song-picture",lyrics:"#song-lyrics"},progress:{currentTime:"#current-time",totalTime:"#total-time",progressBar:"#progress-bar",progressHolder:"#progressbar-holder"},volume:{volumeHolder:"#volume-holder",volumeBar:"#volume-bar"},loading:{loadingHolder:"#loading-holder",loadingBar:"#loading-bar",loadingContainer:"#loading-container"}},volumeIncreaseFactor:8,volume:80},tmp:{mouseIsDown:!1,loading:!1},loading:{start:function(){$("body").addClass("loading"),MusicPlayer.tmp.loading=!0,MusicPlayer.debug&&console.debug("Loading...")},end:function(){$("body").removeClass("loading"),MusicPlayer.tmp.loading=!1,console.debug("Done loading.")}},getInfoFromFilename:function(e,a){e=null==e?"Unkown":e,e=e.replace(/_/g," ");var t=null==t?"Unkown":t;switch(-1!==e.indexOf(" - ")&&(e=e.split(" - "),t=e[0],e=e[1]),e=e.split(".")[0],a){case"a":return t;default:return e}},showMetadata:function(){$(MusicPlayer.settings.elements.metadata.title).html(MusicPlayer.metadata.title),$(MusicPlayer.settings.elements.metadata.artist).html(MusicPlayer.metadata.artist),$(MusicPlayer.settings.elements.metadata.album).html(MusicPlayer.metadata.album),$(MusicPlayer.settings.elements.metadata.track).html(MusicPlayer.metadata.track),$(MusicPlayer.settings.elements.metadata.genre).html(MusicPlayer.metadata.genre),$(MusicPlayer.settings.elements.metadata.year).html(MusicPlayer.metadata.year),$(MusicPlayer.settings.elements.metadata.comment).html(MusicPlayer.metadata.comment),$(MusicPlayer.settings.elements.metadata.lyrics).html(MusicPlayer.metadata.lyrics),$(MusicPlayer.settings.elements.metadata.picture).attr("src",MusicPlayer.metadata.picture)},clearMetadata:function(){$(MusicPlayer.settings.elements.metadata.title).html(null),$(MusicPlayer.settings.elements.metadata.artist).html(null),$(MusicPlayer.settings.elements.metadata.album).html(null),$(MusicPlayer.settings.elements.metadata.year).html(null),$(MusicPlayer.settings.elements.metadata.comment).html(null),$(MusicPlayer.settings.elements.metadata.track).html(null),$(MusicPlayer.settings.elements.metadata.genre).html(null),$(MusicPlayer.settings.elements.metadata.lyrics).html(null)},readMetadata:function(e,a){MusicPlayer.clearMetadata();var t=new ID3.getAllTags(e),s=a;MusicPlayer.metadata.title=t.title,MusicPlayer.metadata.artist=t.artist,MusicPlayer.metadata.album=t.album,MusicPlayer.metadata.genre=t.genre,MusicPlayer.metadata.track=t.track,MusicPlayer.metadata.comment=t.comment,MusicPlayer.metadata.year=t.year,MusicPlayer.metadata.lyrics=t.lyrics;var l=t.picture;void 0!==l&&(MusicPlayer.metadata.picture="data:"+l.format+";base64,"+Base64.encodeBytes(l.data)),void 0===MusicPlayer.metadata.title&&(MusicPlayer.metadata.title=MusicPlayer.getInfoFromFilename(s,"n")),void 0===MusicPlayer.metadata.artist&&(MusicPlayer.metadata.artist=MusicPlayer.getInfoFromFilename(s,"a")),MusicPlayer.showMetadata()},match:function(e,a){var t=a.substring(1,a.length);return e.classList.contains(t)||e.id==t?!0:!1},get:function(){return $(MusicPlayer.settings.player)[0]},play:function(){return""==MusicPlayer.get().currentSrc?(MusicPlayer.debug&&console.error("Cannot play audio. There is not source."),void 0):(MusicPlayer.get().paused?MusicPlayer.get().play():MusicPlayer.get().pause(),void 0)},stop:function(){MusicPlayer.get().pause(),MusicPlayer.get().currentTime=0},next:function(){console.log("Next")},previous:function(){console.log("Previous")},open:function(){MusicPlayer.debug&&console.debug("Open file."),document.querySelector(MusicPlayer.settings.elements.fileOpener).click()},load:function(e){console.debug("Loading file..."),MusicPlayer.get().src=e,document.querySelector(MusicPlayer.settings.elements.waveformImage).src="loading.png",document.querySelector(MusicPlayer.settings.elements.waveformImage).alt="Loading waveform...";new Waveform(e,document.querySelector(MusicPlayer.settings.elements.waveformImage).width,document.querySelector(MusicPlayer.settings.elements.waveformImage).height,"#3498db",document.querySelector("#bar-width").value,document.querySelector("#bar-gaps").value,document.querySelector("#bar-align").value,function(e,a){document.querySelector(MusicPlayer.settings.elements.waveformImage).src=e,document.querySelector("#waveform-svg").src=a,document.querySelector("#progress-holder").style.backgroundImage="url("+a+")"})},durationPercent:function(){return MusicPlayer.get().currentTime/MusicPlayer.get().duration*100},volume:{down:function(){MusicPlayer.volume.set(100*(MusicPlayer.get().volume-MusicPlayer.settings.volumeIncreaseFactor/100))},up:function(){MusicPlayer.volume.set(100*(MusicPlayer.get().volume+MusicPlayer.settings.volumeIncreaseFactor/100))},set:function(e){e=e>100?100:e,e=0>e?0:e,MusicPlayer.get().volume=e/100}},handler:{fileSelect:function(e){var a=e.target.files;$(MusicPlayer.settings.elements.loading.loadingContainer).addClass("loading");for(var t=0;t<a.length;t++){var s=a[t];if(s.type.match("audio.*")){MusicPlayer.debug&&console.debug("Reading file."),$(MusicPlayer.settings.elements.metadata.loadedFile).html(s.name),MusicPlayer.load(URL.createObjectURL(s)),MusicPlayer.debug&&console.debug("Checking for ID3 tags.");var l=new FileReader;l.onloadend=function(){ID3.loadTags(s.urn,function(){MusicPlayer.readMetadata(s.urn,s.name)},{tags:["title","artist","picture","album","year"],dataReader:FileAPIReader(s)})},l.readAsDataURL(s)}else console.error("Not an audio file.")}},play:function(){MusicPlayer.debug&&console.debug("The audio has been started or is no longer paused."),$(MusicPlayer.settings.elements.button.play).removeClass("paused")},pause:function(){MusicPlayer.debug&&console.debug("The audio has been paused."),$(MusicPlayer.settings.elements.button.play).addClass("paused")},seeked:function(){MusicPlayer.debug&&(console.debug("Finished moving to a new position in the audio."),console.debug("New position: "+MusicPlayer.get().currentTime))},seeking:function(){MusicPlayer.debug&&console.debug("Started moving to a new position in the audio.")},stalled:function(){MusicPlayer.debug&&console.debug("The browser is trying to get media data, but data is not available.")},suspend:function(){MusicPlayer.debug&&console.debug("The browser is intentionally not getting media data.")},volumeChange:function(){MusicPlayer.debug&&console.debug("The volume of the audio was changed to "+100*MusicPlayer.get().volume+"%");var e=$(MusicPlayer.settings.elements.volume.volumeBar);$.each(e,function(a){var t=e[a];"PROGRESS"==t.nodeName?($(t).attr("max",100),$(t).val(100*MusicPlayer.get().volume)):$(t).css("width",100*MusicPlayer.get().volume+"%")})},timeUpdate:function(){if($(MusicPlayer.settings.elements.progress.currentTime).html(Time.format(MusicPlayer.get().currentTime)),!MusicPlayer.tmp.mouseIsDown){var e=$(MusicPlayer.settings.elements.progress.progressBar);$.each(e,function(a){var t=e[a];"PROGRESS"==t.nodeName?($(t).attr("max",100),$(t).val(MusicPlayer.durationPercent())):$(t).css("width",MusicPlayer.durationPercent()+"%")})}},canPlay:function(){MusicPlayer.debug&&console.debug("The audio can now be played."),$(MusicPlayer.settings.elements.progress.totalTime).html(Time.format(MusicPlayer.get().duration)),$(MusicPlayer.settings.elements.loading.loadingContainer).removeClass("loading"),MusicPlayer.get().paused&&MusicPlayer.play()},canPlayThrough:function(){MusicPlayer.debug&&console.debug("The audio can now be played through.")},mouseDown:function(e){MusicPlayer.handler.verifyBar(MusicPlayer.settings.elements.progress.progressBar,e.target)&&(MusicPlayer.tmp.mouseIsDown=!0,MusicPlayer.tmp.wasPlaying=!MusicPlayer.get().paused),MusicPlayer.handler.verifyBar(MusicPlayer.settings.elements.volume.volumeBar,e.target)&&(MusicPlayer.tmp.mouseIsDown=!0)},mouseMove:function(e){MusicPlayer.tmp.mouseIsDown&&(MusicPlayer.handler.verifyBar(MusicPlayer.settings.elements.progress.progressBar,e.target)&&MusicPlayer.tmp.mouseIsDown&&("PROGRESS"==e.target.nodeName?$(e.target).val(MusicPlayer.handler.getRelativePerc(e)):MusicPlayer.match(e.target,MusicPlayer.settings.elements.progress.progressBar)?$(e.target).css("width",MusicPlayer.handler.getRelativePerc(e)+"%"):$($(e.target).children()[0]).css("width",MusicPlayer.handler.getRelativePerc(e)+"%")),MusicPlayer.handler.verifyBar(MusicPlayer.settings.elements.volume.volumeBar,e.target)&&MusicPlayer.tmp.mouseIsDown&&("PROGRESS"==e.target.nodeName?$(e.target).val(MusicPlayer.handler.getRelativePerc(e)):MusicPlayer.match(e.target,MusicPlayer.settings.elements.volume.volumeBar)?$(e.target).css("width",MusicPlayer.handler.getRelativePerc(e)+"%"):$($(e.target).children()[0]).css("width",MusicPlayer.handler.getRelativePerc(e)+"%")))},mouseUp:function(e){if(MusicPlayer.tmp.mouseIsDown=!1,MusicPlayer.handler.verifyBar(MusicPlayer.settings.elements.progress.progressBar,e.target)){MusicPlayer.tmp.wasPlaying=!MusicPlayer.get().paused;var a=MusicPlayer.handler.getRelativePerc(e)/100;MusicPlayer.get().currentTime=MusicPlayer.get().duration*a,MusicPlayer.tmp.wasPlaying&&MusicPlayer.get().play()}MusicPlayer.handler.verifyBar(MusicPlayer.settings.elements.volume.volumeBar,e.target)&&(MusicPlayer.tmp.mouseIsDown=!1,MusicPlayer.volume.set(MusicPlayer.handler.getRelativePerc(e)))},mouseOut:function(){MusicPlayer.tmp.mouseIsDown=!1},verifyBar:function(e,a){if(MusicPlayer.match(a,e)&&"PROGRESS"==a.nodeName)return!0;if("PROGRESS"!==a.nodeName){if(MusicPlayer.match(a,e))return!0;var t=$(a).children()[0];if(void 0!==t&&"PROGRESS"!==$(t).nodeName&&MusicPlayer.match(t,e))return!0}return!1},getRelativePerc:function(e){var a=e.target;"PROGRESS"!==a.nodeName&&(MusicPlayer.match(a,MusicPlayer.settings.elements.progress.progressBar)||MusicPlayer.match(a,MusicPlayer.settings.elements.volume.volumeBar))&&(a=a.parentNode);var t=e.pageX-$(a).offset().left,s=$(a).offset().width;return t/s*100}},init:function(e){return MusicPlayer.volume.set(MusicPlayer.settings.volume),$.isPlainObject(e)?($.extend(!0,MusicPlayer.settings,e),void 0):(MusicPlayer.debug&&console.warn("No settings-object available. Using default settings."),void 0)}};$(window).on("load",function(){console.log("~ Using MusicPlayer.js from Jeremy Karlsson (@enjikaka) ~"),console.log("  http://enji.se - http://twitter.com/enjikaka - http://github.com/enjikaka"),console.log("  Thanks for using this Open Source product licenced under the\n  Creative Commons Attribution-ShareAlike 3.0 Generic Licence (CC BY-SA 3.0).");var e=MusicPlayer.settings.elements;$(e.button.play).on("click",MusicPlayer.play),$(e.button.stop).on("click",MusicPlayer.stop),$(e.button.next).on("click",MusicPlayer.next),$(e.button.previous).on("click",MusicPlayer.previous),document.querySelector(e.button.open).onclick=MusicPlayer.selectFile,$(e.button.volumeUp).on("click",MusicPlayer.volume.up),$(e.button.volumeDown).on("click",MusicPlayer.volume.down),$(MusicPlayer.settings.player).on("play",MusicPlayer.handler.play),$(MusicPlayer.settings.player).on("pause",MusicPlayer.handler.pause),$(MusicPlayer.settings.player).on("seeking",MusicPlayer.handler.seeking),$(MusicPlayer.settings.player).on("seeked",MusicPlayer.handler.seeked),$(MusicPlayer.settings.player).on("stalled",MusicPlayer.handler.stalled),$(MusicPlayer.settings.player).on("suspend",MusicPlayer.handler.suspend),$(MusicPlayer.settings.player).on("volumechange",MusicPlayer.handler.volumeChange),$(MusicPlayer.settings.player).on("timeupdate",MusicPlayer.handler.timeUpdate),$(MusicPlayer.settings.player).on("canplay",MusicPlayer.handler.canPlay),$(MusicPlayer.settings.player).on("canplaythrough",MusicPlayer.handler.canPlay),$(MusicPlayer.settings.elements.button.open).on("click",MusicPlayer.open),$(MusicPlayer.settings.elements.fileOpener).on("change",MusicPlayer.handler.fileSelect),$(document).on("mousedown",MusicPlayer.handler.mouseDown),$(document).on("mouseup",MusicPlayer.handler.mouseUp),$(document).on("mousemove",MusicPlayer.handler.mouseMove)});
//# sourceMappingURL=MusicPlayer.min.js.map