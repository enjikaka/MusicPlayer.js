function BufferLoader(o,r,e){this.context=o,this.urlList=r,this.onload=e,this.bufferList=new Array,this.loadCount=0}function WaveformGenerator(o,r,e,a,t,n,f){localStorage.setItem("color",a),window.waveformCanvas.width=r,window.waveformCanvas.height=e,window.waveformBarWidth=parseInt(t),window.waveformBarGap=parseInt(n),window.retFunc=f,window.waveformContext=new AudioContext;var w=new BufferLoader(window.waveformContext,[o],function(o){var r=window.waveformContext.createBufferSource();r.buffer=o[0],window.waveformBuffer=o[0],WaveformGenerator.bufferExtract(window.waveformCanvas.width,WaveformGenerator.drawBar)});w.load()}window.waveformCanvas=document.createElement("canvas"),window.waveformCanvasContext=window.waveformCanvas.getContext("2d"),window.AudioContext=window.AudioContext||window.webkitAudioContext,window.waveformBarWidth=1,window.waveformBarGap=!1,BufferLoader.prototype.loadBuffer=function(o,r){var e=new XMLHttpRequest;e.open("GET",o,!0),e.responseType="arraybuffer";var a=this;e.onload=function(){a.context.decodeAudioData(e.response,function(e){return e?(a.bufferList[r]=e,++a.loadCount==a.urlList.length&&a.onload(a.bufferList),void 0):(console.error("Error decoding file data: "+o),void 0)},function(o){console.error("DecodeAudioData error",o)})},e.onerror=function(){console.error("BufferLoader: XHR error")},e.send()},BufferLoader.prototype.load=function(){for(var o=0;o<this.urlList.length;++o)this.loadBuffer(this.urlList[o],o)},WaveformGenerator.bufferExtract=function(o,r){var e,a=window.waveformBuffer.getChannelData(0),t=Math.floor(a.length/o),n=0,f=function(){var f,w,i;for(f=t,console.log(f);f>n;)if(w=n*t,r(n,WaveformGenerator.bufferMeasure(w,w+t,a)),n+=window.waveformBarWidth,n>=o){clearInterval(e);break}return n==o&&window.retFunc(window.waveformCanvas.toDataURL()),i};return e=setInterval(f,1)},WaveformGenerator.bufferMeasure=function(o,r,e){var a,t,n,f=0;for(a=o,n=r-1;n>=o?n>=a:a>=n;n>=o?a++:a--)t=e[a],f+=t*t;return Math.sqrt(f/e.length)},WaveformGenerator.drawBar=function(o,r){var e=window.waveformCanvasContext,a=localStorage.getItem("color");e.fillStyle=void 0!==a?a:"black";var t;t=50*r*window.waveformCanvas.height;var n=window.waveformBarWidth;return 1==window.waveformBarGap&&(n*=.75),e.fillRect(o,window.waveformCanvas.height/2-t/2,n,t)};
//# sourceMappingURL=WaveformGenerator.min.js.map